// js/script.js
document.addEventListener('DOMContentLoaded', ()=>{
  loadFragment('menu.html','menu-placeholder');
  loadFragment('footer.html','footer-placeholder', ()=>{
    const el = document.getElementById('year'); if(el) el.textContent = new Date().getFullYear();
  });

  // sounds
  window.sounds = {
    click: new Audio('assets/sounds/click.mp3'),
    correct: new Audio('assets/sounds/correct.mp3'),
    wrong: new Audio('assets/sounds/wrong.mp3'),
    bg: new Audio('assets/sounds/action-187118.mp3')
  };
  if(window.sounds.bg){ window.sounds.bg.loop = true; window.sounds.bg.volume = 0.12; }

  window.playS = (k) => { try{ if(window.sounds[k]){ window.sounds[k].currentTime = 0; window.sounds[k].play(); } } catch(e){} };

  // call page-specific init if found (functions defined inline in pages)
  try { if(typeof pageInitHost === 'function' && location.pathname.endsWith('questions.html')) pageInitHost(); } catch(e){}
  try { if(typeof pageInitPlay === 'function' && location.pathname.endsWith('jouer.html')) pageInitPlay(); } catch(e){}
  try { if(typeof pageInitResult === 'function' && location.pathname.endsWith('resultat.html')) pageInitResult(); } catch(e){}
  try { if(typeof pageInitScore === 'function' && location.pathname.endsWith('score.html')) pageInitScore(); } catch(e){}
});

// load html fragments for menu/footer
function loadFragment(url, placeholderId, cb){
  fetch(url).then(r=>r.text()).then(html=>{
    const c = document.getElementById(placeholderId);
    if(c) c.innerHTML = html;
    cb && cb();
  }).catch(e=>console.warn('Fragment load failed', url, e));
}